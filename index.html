<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Trading Floor â€” TCD MSc Finance Research</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:wght@400;700&family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#06060d;--surface:#0c0c18;--card:#111122;--card2:#161630;
  --border:#1c1c35;--border2:#282848;
  --cyan:#00f5ff;--purple:#8b5cf6;--green:#00e676;
  --amber:#ffb300;--red:#ff3d57;--pink:#ff6b9d;
  --text:#dde1ff;--muted:#5c607a;--muted2:#8890b0;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'IBM Plex Sans',sans-serif;min-height:100vh;overflow-x:hidden;}

/* â”€â”€ CANVAS â”€â”€ */
#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none;}

/* â”€â”€ TICKER â”€â”€ */
.ticker{position:fixed;top:0;left:0;width:100%;z-index:300;height:26px;background:var(--surface);border-bottom:1px solid var(--border2);overflow:hidden;display:flex;align-items:center;}
.ticker-track{display:flex;animation:tickRun 50s linear infinite;white-space:nowrap;}
@keyframes tickRun{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.tick{font-family:'Space Mono',monospace;font-size:10px;padding:0 18px;color:var(--muted2);letter-spacing:.5px;}
.tick b{color:var(--text);}
.tick.up b.val{color:var(--green);}
.tick.dn b.val{color:var(--red);}

/* â”€â”€ PROGRESS â”€â”€ */
.prog-bar{position:fixed;top:26px;left:0;width:100%;height:2px;background:var(--border);z-index:299;}
.prog-fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--purple),var(--pink));transition:width .5s ease;width:0%;}

/* â”€â”€ HEADER â”€â”€ */
header{position:relative;z-index:10;padding:48px 40px 18px;text-align:center;border-bottom:1px solid var(--border);}
.hd-logo{font-family:'Bebas Neue',sans-serif;font-size:42px;letter-spacing:8px;color:var(--cyan);line-height:1;}
.hd-sub{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:4px;margin-top:5px;}

/* â”€â”€ SCREENS â”€â”€ */
.screen{display:none;position:relative;z-index:10;}
.screen.active{display:block;}

/* â•â•â•â•â•â•â•â•â•â• INTRO â•â•â•â•â•â•â•â•â•â• */
#intro{max-width:720px;margin:0 auto;padding:48px 28px 80px;text-align:center;}
.badge-live{display:inline-flex;align-items:center;gap:8px;background:rgba(0,245,255,.07);border:1px solid rgba(0,245,255,.25);border-radius:3px;padding:6px 16px;font-family:'Space Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--cyan);margin-bottom:28px;}
.blink{width:7px;height:7px;border-radius:50%;background:var(--cyan);animation:blink 1.4s ease infinite;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}
.intro-h{font-family:'Bebas Neue',sans-serif;font-size:58px;letter-spacing:2px;line-height:1;margin-bottom:18px;}
.intro-h span{background:linear-gradient(120deg,var(--cyan),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.intro-p{font-size:15px;line-height:1.85;color:var(--muted2);max-width:580px;margin:0 auto 18px;}
.research-box{background:rgba(139,92,246,.07);border:1px solid rgba(139,92,246,.25);border-radius:10px;padding:18px 22px;font-size:12px;color:var(--muted2);line-height:1.75;text-align:left;margin:18px 0 32px;}
.research-box strong{color:var(--purple);}
.phases{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:36px;}
.ph{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:18px 14px;text-align:left;}
.ph-letter{font-family:'Bebas Neue',sans-serif;font-size:36px;line-height:1;color:var(--border2);}
.ph-name{font-size:11px;font-weight:600;color:var(--text);margin-top:8px;}
.ph-desc{font-size:10px;color:var(--muted);margin-top:4px;line-height:1.5;}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{background:linear-gradient(135deg,var(--cyan),var(--purple));color:#000;border:none;padding:15px 42px;font-family:'Space Mono',monospace;font-size:11px;font-weight:700;letter-spacing:2px;cursor:pointer;border-radius:4px;transition:all .2s;text-transform:uppercase;}
.btn:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,245,255,.25);}
.btn:disabled{opacity:.4;cursor:not-allowed;transform:none;}
.btn-sm{background:var(--card2);color:var(--text);border:1px solid var(--border2);padding:10px 24px;font-family:'Space Mono',monospace;font-size:10px;letter-spacing:1px;cursor:pointer;border-radius:4px;transition:all .2s;text-transform:uppercase;}
.btn-sm:hover{border-color:var(--cyan);color:var(--cyan);}
.btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--muted2);padding:10px 22px;font-family:'Space Mono',monospace;font-size:10px;letter-spacing:1px;cursor:pointer;border-radius:4px;transition:all .2s;text-transform:uppercase;}
.btn-ghost:hover{border-color:var(--purple);color:var(--text);}

/* â•â•â•â•â•â•â•â•â•â• SECTION WRAPPER â•â•â•â•â•â•â•â•â•â• */
#game{max-width:900px;margin:0 auto;padding:32px 22px 80px;}
.sec-hdr{display:flex;align-items:center;gap:14px;margin-bottom:26px;padding-bottom:18px;border-bottom:1px solid var(--border);}
.sec-tag{font-family:'Space Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--cyan);background:rgba(0,245,255,.08);border:1px solid rgba(0,245,255,.2);padding:4px 12px;border-radius:2px;white-space:nowrap;}
.sec-title{font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:2px;color:var(--text);}
.sec-step{margin-left:auto;font-family:'Space Mono',monospace;font-size:10px;color:var(--muted);}

/* â”€â”€ Q CARD â”€â”€ */
.qcard{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:28px 30px;margin-bottom:18px;animation:fadeUp .35s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.qlabel{font-family:'Space Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--muted);margin-bottom:14px;}
.qtext{font-size:17px;font-weight:500;line-height:1.6;color:var(--text);margin-bottom:22px;}

/* â”€â”€ OPTIONS â”€â”€ */
.opts{display:flex;flex-direction:column;gap:9px;}
.opt{background:var(--surface);border:1.5px solid var(--border);border-radius:8px;padding:13px 18px;cursor:pointer;display:flex;align-items:center;gap:13px;transition:all .15s;font-size:14px;color:var(--text);}
.opt:hover{border-color:var(--purple);background:rgba(139,92,246,.07);transform:translateX(4px);}
.opt.sel{border-color:var(--cyan);background:rgba(0,245,255,.07);}
.opt-mark{width:18px;height:18px;border-radius:50%;border:2px solid var(--border2);flex-shrink:0;transition:all .15s;}
.opt.sel .opt-mark{border-color:var(--cyan);background:var(--cyan);}
.chk-mark{width:18px;height:18px;border-radius:4px;border:2px solid var(--border2);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:10px;transition:all .15s;}
.opt.sel .chk-mark{border-color:var(--cyan);background:var(--cyan);color:#000;}

/* multi-col options */
.opts-2col{display:grid;grid-template-columns:1fr 1fr;gap:9px;}

/* â”€â”€ LIKERT â”€â”€ */
.lk-wrap{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px 28px;margin-bottom:13px;animation:fadeUp .35s ease;}
.lk-stmt{font-size:15px;font-weight:500;line-height:1.65;color:var(--text);margin-bottom:20px;}
.lk-row{display:flex;align-items:center;gap:10px;}
.lk-end{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted2);line-height:1.4;min-width:75px;}
.lk-end.r{text-align:right;}
.lk-dots{display:flex;flex:1;justify-content:center;gap:10px;}
.lk-dot{width:46px;height:46px;border-radius:50%;border:2px solid var(--border2);background:var(--surface);cursor:pointer;display:flex;align-items:center;justify-content:center;font-family:'Space Mono',monospace;font-size:12px;color:var(--muted2);transition:all .15s;}
.lk-dot:hover{border-color:var(--purple);color:var(--text);transform:scale(1.1);}
.lk-dot.sel{border-color:var(--cyan);background:rgba(0,245,255,.12);color:var(--cyan);transform:scale(1.15);}

/* â”€â”€ NAV â”€â”€ */
.nav{display:flex;justify-content:space-between;align-items:center;margin-top:18px;}

/* â•â•â•â•â•â•â•â•â•â• SECTION C â€” TRADING GAME â•â•â•â•â•â•â•â•â•â• */
#tradingGame{}
.tg-layout{display:grid;grid-template-columns:280px 1fr;gap:18px;align-items:start;}

/* Portfolio sidebar */
.portfolio-panel{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:20px;position:sticky;top:80px;}
.pp-title{font-family:'Space Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--muted);margin-bottom:16px;}
.cash-display{background:var(--surface);border:1px solid var(--border2);border-radius:8px;padding:14px 16px;margin-bottom:14px;}
.cash-lbl{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:2px;margin-bottom:4px;}
.cash-val{font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--green);line-height:1;}
.assets-list{display:flex;flex-direction:column;gap:8px;margin-bottom:14px;}
.asset-row{background:var(--surface);border:1px solid var(--border);border-radius:7px;padding:10px 13px;}
.asset-name{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted2);letter-spacing:1px;margin-bottom:3px;}
.asset-val{font-size:13px;font-weight:600;color:var(--text);}
.asset-pnl{font-family:'Space Mono',monospace;font-size:10px;margin-top:2px;}
.asset-pnl.up{color:var(--green);}
.asset-pnl.dn{color:var(--red);}
.port-total{background:linear-gradient(135deg,rgba(0,245,255,.08),rgba(139,92,246,.08));border:1px solid var(--border2);border-radius:8px;padding:12px 14px;}
.pt-lbl{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:2px;margin-bottom:4px;}
.pt-val{font-family:'Bebas Neue',sans-serif;font-size:28px;line-height:1;}
.pt-val.up{color:var(--green);}
.pt-val.dn{color:var(--red);}
.pt-val.neutral{color:var(--text);}
.event-counter{display:flex;gap:6px;margin-bottom:14px;}
.ev-dot{width:10px;height:10px;border-radius:50%;border:2px solid var(--border2);transition:all .3s;}
.ev-dot.done{background:var(--cyan);border-color:var(--cyan);}
.ev-dot.active{background:var(--amber);border-color:var(--amber);box-shadow:0 0 8px var(--amber);}

/* Event panel */
.event-panel{display:flex;flex-direction:column;gap:14px;}
.event-card{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;animation:fadeUp .4s ease;}
.event-top{padding:20px 24px 16px;border-bottom:1px solid var(--border);}
.breaking{display:inline-flex;align-items:center;gap:7px;background:rgba(255,61,87,.12);border:1px solid rgba(255,61,87,.3);border-radius:3px;padding:3px 10px;font-family:'Space Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--red);margin-bottom:10px;}
.breaking-dot{width:6px;height:6px;border-radius:50%;background:var(--red);animation:blink 1s infinite;}
.event-title{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--text);margin-bottom:8px;}
.event-desc{font-size:13px;line-height:1.65;color:var(--muted2);}
.affected-tag{display:inline-block;margin-top:10px;font-family:'Space Mono',monospace;font-size:9px;padding:3px 10px;border-radius:2px;background:rgba(255,179,0,.1);color:var(--amber);border:1px solid rgba(255,179,0,.3);}

/* Instrument cards */
.inst-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:20px 24px;}
.inst-card{background:var(--surface);border:2px solid var(--border);border-radius:10px;padding:16px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden;}
.inst-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:transparent;transition:background .2s;}
.inst-card:hover{border-color:var(--purple);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.4);}
.inst-card:hover::before{background:var(--purple);}
.inst-card.sel-hedge{border-color:var(--green);}
.inst-card.sel-hedge::before{background:var(--green);}
.inst-card.sel-spec{border-color:var(--red);}
.inst-card.sel-spec::before{background:var(--red);}
.inst-card.sel-neutral{border-color:var(--amber);}
.inst-card.sel-neutral::before{background:var(--amber);}
.inst-card.dimmed{opacity:.3;pointer-events:none;}
.inst-type{font-family:'Space Mono',monospace;font-size:8px;letter-spacing:2px;padding:2px 8px;border-radius:2px;display:inline-block;margin-bottom:10px;}
.inst-type.hedge{background:rgba(0,230,118,.12);color:var(--green);}
.inst-type.spec{background:rgba(255,61,87,.12);color:var(--red);}
.inst-type.neutral{background:rgba(255,179,0,.1);color:var(--amber);}
.inst-name{font-size:13px;font-weight:600;color:var(--text);margin-bottom:6px;line-height:1.3;}
.inst-desc{font-size:11px;color:var(--muted2);line-height:1.5;margin-bottom:10px;}
.inst-cost{font-family:'Space Mono',monospace;font-size:11px;color:var(--cyan);}

/* Outcome flash */
.outcome-overlay{position:fixed;inset:0;background:rgba(6,6,13,.9);z-index:400;display:none;flex-direction:column;align-items:center;justify-content:center;animation:fadeIn .3s ease;}
.outcome-overlay.active{display:flex;}
.outcome-overlay.active{display:flex;}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.outcome-box{background:var(--card);border:1px solid var(--border2);border-radius:16px;padding:40px 48px;text-align:center;max-width:480px;width:90%;}
.outcome-emoji{font-size:56px;margin-bottom:12px;animation:pop .4s ease;}
@keyframes pop{0%{transform:scale(0.5)}80%{transform:scale(1.15)}100%{transform:scale(1)}}
.outcome-title{font-family:'Bebas Neue',sans-serif;font-size:36px;letter-spacing:2px;margin-bottom:10px;}
.outcome-title.good{color:var(--green);}
.outcome-title.bad{color:var(--red);}
.outcome-title.neutral{color:var(--amber);}
.outcome-desc{font-size:14px;color:var(--muted2);line-height:1.7;margin-bottom:24px;}
.outcome-delta{font-family:'Space Mono',monospace;font-size:16px;font-weight:700;margin-bottom:20px;}
.outcome-delta.pos{color:var(--green);}
.outcome-delta.neg{color:var(--red);}

/* â•â•â•â•â•â•â•â•â•â• THANK YOU â•â•â•â•â•â•â•â•â•â• */
#thankyou{max-width:680px;margin:0 auto;padding:60px 28px 80px;text-align:center;}
.ty-glyph{font-size:72px;animation:levitate 2s ease-in-out infinite alternate;display:block;}
@keyframes levitate{from{transform:translateY(0)}to{transform:translateY(-14px)}}
.ty-h{font-family:'Bebas Neue',sans-serif;font-size:64px;letter-spacing:4px;line-height:1;background:linear-gradient(120deg,var(--green),var(--cyan),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px;}
.ty-sub{font-family:'Space Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--cyan);margin-bottom:32px;}
.ty-saved{display:inline-flex;align-items:center;gap:8px;background:rgba(0,230,118,.08);border:1px solid rgba(0,230,118,.3);border-radius:4px;padding:10px 20px;font-family:'Space Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--green);margin-bottom:28px;}
.ty-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:30px;margin-bottom:20px;}
.ty-msg{font-size:17px;line-height:1.8;color:var(--text);margin-bottom:14px;}
.ty-note{font-size:13px;color:var(--muted2);line-height:1.75;}
.ty-note strong{color:var(--purple);}
.ty-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:24px 0;}
.ty-stat{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:20px 12px;}
.ty-num{font-family:'Bebas Neue',sans-serif;font-size:48px;color:var(--cyan);line-height:1;}
.ty-lbl{font-family:'Space Mono',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);margin-top:6px;}
.ty-footer{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:2px;margin-top:20px;}

/* confetti */
.confetti-wrap{position:fixed;inset:0;pointer-events:none;z-index:5;overflow:hidden;}
.cp{position:absolute;width:8px;height:8px;border-radius:2px;animation:fall linear forwards;}
@keyframes fall{0%{transform:translateY(-20px) rotate(0deg);opacity:1;}100%{transform:translateY(105vh) rotate(540deg);opacity:0;}}

/* sending */
.sending{position:fixed;inset:0;background:rgba(6,6,13,.88);z-index:500;display:none;flex-direction:column;align-items:center;justify-content:center;}
.sending.on{display:flex;}
.spin{width:44px;height:44px;border-radius:50%;border:3px solid var(--border2);border-top-color:var(--cyan);animation:spin .7s linear infinite;margin-bottom:14px;}
@keyframes spin{to{transform:rotate(360deg)}}
.send-txt{font-family:'Space Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted2);}

@media(max-width:680px){
  .phases{grid-template-columns:1fr 1fr;}
  .tg-layout{grid-template-columns:1fr;}
  .portfolio-panel{position:static;}
  .inst-grid{grid-template-columns:1fr;}
  .opts-2col{grid-template-columns:1fr;}
  .ty-stats{grid-template-columns:1fr;}
  .intro-h{font-size:40px;}
}
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>
<div class="confetti-wrap" id="confettiWrap"></div>
<div class="sending" id="sendingOverlay"><div class="spin"></div><div class="send-txt">TRANSMITTING DATA TO SECURE DATABASE...</div></div>
<div class="outcome-overlay" id="outcomeOverlay"></div>

<!-- TICKER -->
<div class="ticker"><div class="ticker-track" id="tickerTrack"></div></div>
<div class="prog-bar"><div class="prog-fill" id="progFill"></div></div>

<header>
  <div class="hd-logo">THE TRADING FLOOR</div>
  <div class="hd-sub">Trinity College Dublin Â· MSc Finance Research Â· 2025</div>
</header>

<!-- â•â• INTRO â•â• -->
<div id="intro" class="screen active">
  <div class="badge-live"><div class="blink"></div>RESEARCH PARTICIPATION Â· ~15 MINS</div>
  <h1 class="intro-h">How do you <span>really</span> trade?</h1>
  <p class="intro-p">You're about to step onto a simulated trading floor. Face real market scenarios, make live decisions, and reveal your instincts. This isn't a quiz with right or wrong answers â€” it's a window into how financial knowledge shapes investor behaviour.</p>
  <div class="research-box">
    <strong>Research Disclosure:</strong> This experiment is part of an MSc Finance dissertation at Trinity College Dublin titled <em>"Exploring Investor Motives in the Derivatives Market: The Role of Financial Literacy, Hedging, and Speculation."</em> All responses are completely anonymous. No personally identifiable data is collected. Participation is voluntary.
  </div>
  <div class="phases">
    <div class="ph"><div class="ph-letter">A</div><div class="ph-name">About You</div><div class="ph-desc">5 background questions</div></div>
    <div class="ph"><div class="ph-letter">B</div><div class="ph-name">Your Knowledge</div><div class="ph-desc">5 financial literacy statements</div></div>
    <div class="ph"><div class="ph-letter">C</div><div class="ph-name">Live Trading</div><div class="ph-desc">Trade â‚¬10,000 across 5 market events</div></div>
    <div class="ph"><div class="ph-letter">D</div><div class="ph-name">Your Motivation</div><div class="ph-desc">5 investor motivation statements</div></div>
  </div>
  <button class="btn" onclick="startGame()">ENTER THE FLOOR â†’</button>
</div>

<!-- â•â• SECTIONS A, B, D â•â• -->
<div id="game" class="screen">
  <div class="sec-hdr">
    <div class="sec-tag" id="secTag">SECTION A</div>
    <div class="sec-title" id="secTitle">ABOUT YOU</div>
    <div class="sec-step" id="secStep">Q1 of 20</div>
  </div>
  <div id="qArea"></div>
  <div class="nav"><span></span><button class="btn" id="nextBtn" onclick="nextStep()" style="display:none">NEXT â†’</button></div>
</div>

<!-- â•â• SECTION C: TRADING GAME â•â• -->
<div id="tradingGame" class="screen">
  <div class="sec-hdr">
    <div class="sec-tag">SECTION C â€” LIVE TRADING</div>
    <div class="sec-title">THE TRADING FLOOR</div>
    <div class="sec-step" id="eventStep">EVENT 1 OF 5</div>
  </div>
  <div class="tg-layout">
    <!-- Portfolio Sidebar -->
    <div class="portfolio-panel">
      <div class="pp-title">YOUR PORTFOLIO</div>
      <div class="event-counter" id="eventCounter"></div>
      <div class="cash-display">
        <div class="cash-lbl">AVAILABLE CASH</div>
        <div class="cash-val" id="cashDisplay">â‚¬10,000</div>
      </div>
      <div class="assets-list" id="assetsList"></div>
      <div class="port-total">
        <div class="pt-lbl">TOTAL PORTFOLIO VALUE</div>
        <div class="pt-val neutral" id="totalVal">â‚¬22,500</div>
      </div>
    </div>
    <!-- Event Panel -->
    <div class="event-panel" id="eventPanel"></div>
  </div>
</div>

<!-- â•â• THANK YOU â•â• -->
<div id="thankyou" class="screen">
  <span class="ty-glyph">ğŸ†</span>
  <div class="ty-h">MISSION COMPLETE</div>
  <div class="ty-sub">â— LEVEL CLEARED Â· DATA TRANSMITTED â—</div>
  <div class="ty-saved"><span>âœ“</span> RESPONSE RECORDED ANONYMOUSLY</div>
  <div class="ty-card">
    <div class="ty-msg">You just played the market â€” and the market played you back.</div>
    <div class="ty-note">There were no right or wrong answers. Every decision you made â€” every trade, every statement â€” reveals something real about how financial minds work. That's exactly what this research is here to uncover.<br><br>Your anonymous responses contribute to <strong>Exploring Investor Motives in the Derivatives Market</strong> â€” an MSc Finance study at Trinity College Dublin. You've helped make academic research a little more human.</div>
    <div class="ty-stats">
      <div class="ty-stat"><div class="ty-num">20</div><div class="ty-lbl">QUESTIONS<br>ANSWERED</div></div>
      <div class="ty-stat"><div class="ty-num">4</div><div class="ty-lbl">SECTIONS<br>COMPLETED</div></div>
      <div class="ty-stat"><div class="ty-num" id="tyFinalPort">â‚¬0</div><div class="ty-lbl">FINAL<br>PORTFOLIO</div></div>
    </div>
  </div>
  <div class="ty-footer">THANK YOU FOR YOUR TIME Â· NOW GO TRADE SOMETHING REAL ğŸ“ˆ</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GOOGLE SHEETS â€” paste your URL here
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SHEETS_URL = 'https://script.google.com/macros/s/AKfycbyMi_DC4aQld8h-CO_WBQKB-9A1JSyXjIoEvWNBj3TBWwIKayHj0Qd4E5aYNd5WXCpzBQ/exec';

// â”€â”€ TICKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TICKS = [
  {sym:'ISEQ',val:'9,847',dir:'up',chg:'+1.2%'},
  {sym:'EUR/USD',val:'1.0821',dir:'dn',chg:'-0.3%'},
  {sym:'EUROSTOXX50',val:'5,102',dir:'up',chg:'+0.8%'},
  {sym:'BUND 10Y',val:'2.41%',dir:'dn',chg:'-4bp'},
  {sym:'VIX',val:'18.6',dir:'up',chg:'+4.1%'},
  {sym:'CRUDE OIL',val:'$78.44',dir:'dn',chg:'-0.9%'},
  {sym:'GOLD',val:'$2,318',dir:'up',chg:'+0.5%'},
  {sym:'DAX',val:'18,204',dir:'up',chg:'+0.6%'},
  {sym:'S&P 500',val:'5,234',dir:'up',chg:'+0.4%'},
  {sym:'FTSE 100',val:'8,102',dir:'dn',chg:'-0.2%'},
  {sym:'BTC/USD',val:'67,400',dir:'up',chg:'+2.1%'},
  {sym:'SILVER',val:'$28.4',dir:'up',chg:'+0.7%'},
  {sym:'EUR/GBP',val:'0.8542',dir:'dn',chg:'-0.1%'},
  {sym:'WHEAT',val:'$612',dir:'up',chg:'+1.4%'},
];
(function buildTicker(){
  const t = document.getElementById('tickerTrack');
  const items = [...TICKS,...TICKS];
  t.innerHTML = items.map(x=>`<span class="tick ${x.dir}"><b>${x.sym}</b> &nbsp;<b class="val">${x.val} ${x.dir==='up'?'â–²':'â–¼'} ${x.chg}</b> &nbsp;|&nbsp;</span>`).join('');
})();

// â”€â”€ CANVAS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function initCanvas(){
  const c = document.getElementById('bgCanvas');
  const ctx = c.getContext('2d');
  let W,H,pts=[];
  const resize=()=>{W=c.width=innerWidth;H=c.height=innerHeight;};
  resize(); window.addEventListener('resize',resize);
  const init=()=>{pts=[];for(let i=0;i<Math.floor(W*H/14000);i++)pts.push({x:Math.random()*W,y:Math.random()*H,vx:(Math.random()-.5)*.25,vy:(Math.random()-.5)*.25});};
  init();
  const draw=()=>{
    ctx.clearRect(0,0,W,H);
    ctx.strokeStyle='rgba(20,20,42,0.8)';ctx.lineWidth=1;
    for(let x=0;x<W;x+=55){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,H);ctx.stroke();}
    for(let y=0;y<H;y+=55){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(W,y);ctx.stroke();}
    pts.forEach(p=>{
      p.x+=p.vx;p.y+=p.vy;
      if(p.x<0||p.x>W)p.vx*=-1;if(p.y<0||p.y>H)p.vy*=-1;
      ctx.beginPath();ctx.arc(p.x,p.y,1,0,Math.PI*2);
      ctx.fillStyle='rgba(0,245,255,0.4)';ctx.fill();
    });
    pts.forEach((a,i)=>pts.slice(i+1).forEach(b=>{
      const d=Math.hypot(a.x-b.x,a.y-b.y);
      if(d<100){ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);ctx.strokeStyle=`rgba(139,92,246,${.12*(1-d/100)})`;ctx.lineWidth=.5;ctx.stroke();}
    }));
    requestAnimationFrame(draw);
  };
  draw();
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let responses = {};
let phase = 'A'; // A | B | C | D
let qIdx = 0;

// Portfolio state
let cash = 10000;
let assets = [
  {name:'TECH STOCK (SAP SE)',base:4500,current:4500,pnl:0},
  {name:'OIL ETF',base:3500,current:3500,pnl:0},
  {name:'EURO BONDS',base:4500,current:4500,pnl:0}
];
let eventIdx = 0;
let tradeChoices = []; // stores {type:'hedge'|'spec'|'neutral'|'hold', score:1-5} for Q11-Q15

// â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setProgress(pct){ document.getElementById('progFill').style.width=pct+'%'; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION A â€” DEMOGRAPHICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const demoQs = [
  {id:'Q1',text:'What is your gender?',type:'single',opts:['Male','Female','Non-binary','Prefer not to say']},
  {id:'Q2',text:'What is your age group?',type:'single',opts:['18â€“24','25â€“34','35â€“44','45â€“54','55+']},
  {id:'Q3',text:'What is your highest level of education?',type:'single',opts:['Undergraduate degree','Postgraduate degree','Professional qualification (CFA, ACCA, etc.)','Other']},
  {id:'Q4',text:'How long have you been trading or investing?',type:'single',opts:['Less than 1 year','1â€“3 years','3â€“5 years','5+ years',"I don't trade but have financial knowledge"]},
  {id:'Q5',text:'Which financial instruments have you used or studied? (Select all that apply)',type:'multi',opts:['Futures','Options','Forwards']},
];

function renderDemo(idx){
  const q=demoQs[idx];
  setProgress((idx/20)*100);
  document.getElementById('secTag').textContent='SECTION A â€” DEMOGRAPHICS';
  document.getElementById('secTitle').textContent='ABOUT YOU';
  document.getElementById('secStep').textContent=`Q${idx+1} of 20`;
  document.getElementById('nextBtn').style.display='none';
  const multi=q.type==='multi';
  document.getElementById('qArea').innerHTML=`
    <div class="qcard">
      <div class="qlabel">QUESTION ${idx+1} OF 5</div>
      <div class="qtext">${q.text}</div>
      <div class="opts" id="optsCont">
        ${q.opts.map((o,i)=>`
          <div class="opt" id="dopt_${i}" onclick="pickDemo(${i},'${q.id}',${multi})">
            <div class="${multi?'chk-mark':'opt-mark'}">${multi&&responses[q.id]&&responses[q.id].includes(o)?'âœ“':''}</div>
            <span>${o}</span>
          </div>`).join('')}
      </div>
    </div>`;
  // restore
  if(responses[q.id]!==undefined){
    if(multi){
      (responses[q.id]||[]).forEach(v=>{const i=q.opts.indexOf(v);if(i>=0){document.getElementById(`dopt_${i}`).classList.add('sel');document.getElementById(`dopt_${i}`).querySelector('.chk-mark').textContent='âœ“';}});
      if((responses[q.id]||[]).length) document.getElementById('nextBtn').style.display='inline-block';
    } else {
      const i=q.opts.indexOf(responses[q.id]);
      if(i>=0) document.getElementById(`dopt_${i}`).classList.add('sel');
      document.getElementById('nextBtn').style.display='inline-block';
    }
  }
}

function pickDemo(idx,qid,multi){
  const q=demoQs.find(x=>x.id===qid);
  if(multi){
    const el=document.getElementById(`dopt_${idx}`);
    el.classList.toggle('sel');
    const chk=el.querySelector('.chk-mark');
    chk.textContent=el.classList.contains('sel')?'âœ“':'';
    const vals=[...document.querySelectorAll('.opt.sel')].map(e=>q.opts[parseInt(e.id.split('_')[1])]);
    responses[qid]=vals;
    document.getElementById('nextBtn').style.display=vals.length?'inline-block':'none';
  } else {
    document.querySelectorAll('.opt').forEach(e=>e.classList.remove('sel'));
    document.getElementById(`dopt_${idx}`).classList.add('sel');
    responses[qid]=q.opts[idx];
    document.getElementById('nextBtn').style.display='inline-block';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION B â€” FINANCIAL LITERACY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const flStmts=[
  'I understand how futures contracts are priced and settled.',
  'I understand the difference between call and put options.',
  'I am aware of the margin requirements involved in derivatives trading.',
  'I understand how leverage works in derivatives markets.',
  'I can assess the risk-reward profile of a derivatives instrument before trading.'
];

function renderFL(idx){
  const qn=6+idx;
  setProgress(((5+idx)/20)*100);
  document.getElementById('secTag').textContent='SECTION B â€” FINANCIAL LITERACY';
  document.getElementById('secTitle').textContent='YOUR KNOWLEDGE';
  document.getElementById('secStep').textContent=`Q${qn} of 20`;
  document.getElementById('nextBtn').style.display='none';
  const saved=responses['Q'+qn];
  document.getElementById('qArea').innerHTML=`
    <div class="lk-wrap">
      <div class="qlabel">QUESTION ${idx+1} OF 5 Â· RATE YOUR AGREEMENT</div>
      <div class="lk-stmt">${flStmts[idx]}</div>
      <div class="lk-row">
        <div class="lk-end">Strongly<br>Disagree</div>
        <div class="lk-dots">
          ${[1,2,3,4,5].map(n=>`<div class="lk-dot ${saved===n?'sel':''}" id="ld_${n}" onclick="pickFL(${n},'Q${qn}')">${n}</div>`).join('')}
        </div>
        <div class="lk-end r">Strongly<br>Agree</div>
      </div>
    </div>`;
  if(saved!==undefined) document.getElementById('nextBtn').style.display='inline-block';
}

function pickFL(val,qid){
  document.querySelectorAll('.lk-dot').forEach(d=>d.classList.remove('sel'));
  document.getElementById(`ld_${val}`).classList.add('sel');
  responses[qid]=val;
  document.getElementById('nextBtn').style.display='inline-block';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION C â€” TRADING GAME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const EVENTS = [
  {
    title:'TECH EARNINGS MISS',
    desc:'SAP SE reports earnings 15% below analyst expectations. Markets react immediately â€” tech stocks slide across the board.',
    affected:'YOUR TECH STOCK IS DOWN 8%',
    assetIdx:0, assetChange:-0.08,
    instruments:[
      {type:'hedge',name:'Take out price protection',desc:'Pay to protect your tech stock from falling further. Limits your downside.',cost:500,outcome:'Your protection kicks in â€” losses capped. Smart defensive move.',outcomeDelta:+400,score:1},
      {type:'spec',name:'Bet it will keep falling',desc:'Open a position that pays out if the stock continues to drop.',cost:800,outcome:'The stock bounces back â€” your bet loses. Market is unpredictable.',outcomeDelta:-600,score:5},
      {type:'neutral',name:'Sell the stock now',desc:'Exit your tech position entirely. Take the loss, move to cash.',cost:0,outcome:'You exited â€” avoided further pain but missed a partial recovery.',outcomeDelta:+150,score:3},
      {type:'hedge',name:'Hold and do nothing',desc:"Stay put. No additional cost. See how things develop.",cost:0,outcome:'Stock stays flat after the initial drop. Your patience holds.',outcomeDelta:0,score:2},
    ]
  },
  {
    title:'OIL PRICE SPIKE',
    desc:'OPEC announces a surprise production cut. Oil prices surge 12% in a single session.',
    affected:'YOUR OIL ETF IS UP 12%',
    assetIdx:1, assetChange:+0.12,
    instruments:[
      {type:'hedge',name:'Lock in your oil gains now',desc:'Secure the profit by agreeing to sell at the current high price.',cost:300,outcome:'You locked in gains before a small pullback. Textbook hedging.',outcomeDelta:+380,score:1},
      {type:'spec',name:'Double down on oil rising',desc:'Put more cash into an oil position â€” bet prices keep climbing.',cost:1200,outcome:'Oil pulls back slightly â€” your leveraged bet loses some ground.',outcomeDelta:-400,score:5},
      {type:'neutral',name:'Protect your other assets',desc:'High oil hurts airlines and manufacturers. Shield those positions.',cost:400,outcome:'Your broader portfolio is protected from oil knock-on effects.',outcomeDelta:+200,score:2},
      {type:'neutral',name:'Hold and watch',desc:'Do nothing â€” enjoy the gain and monitor the situation.',cost:0,outcome:'Oil holds steady. Your ETF gain is intact.',outcomeDelta:0,score:3},
    ]
  },
  {
    title:'ECB EMERGENCY RATE HIKE',
    desc:'The ECB announces an unexpected 75bp rate hike to combat inflation. Bond markets take a sharp hit.',
    affected:'YOUR EURO BONDS ARE DOWN 6%',
    assetIdx:2, assetChange:-0.06,
    instruments:[
      {type:'hedge',name:'Take out interest rate protection',desc:'A contract that pays out when rates rise â€” offsets your bond losses.',cost:600,outcome:'Your rate protection activates â€” bond losses largely offset. Solid hedge.',outcomeDelta:+520,score:1},
      {type:'spec',name:'Bet rates keep rising',desc:'Open a position that profits if the ECB hikes again.',cost:900,outcome:'ECB pauses â€” no further hike. Your speculative bet expires worthless.',outcomeDelta:-700,score:5},
      {type:'neutral',name:'Sell bonds, buy short-term cash',desc:'Exit long bonds and park money in shorter-term instruments.',cost:0,outcome:'You reduced duration risk â€” portfolio stabilises.',outcomeDelta:+100,score:3},
      {type:'hedge',name:'Hold â€” rates may fall back',desc:'Stay in your bonds. Central banks often reverse course.',cost:0,outcome:'Bonds recover 40% of losses over the following week.',outcomeDelta:+160,score:2},
    ]
  },
  {
    title:'DOLLAR WEAKENS SHARPLY',
    desc:"You've just received a â‚¬5,000 bonus payment in US dollars. The dollar suddenly weakens 5% against the euro.",
    affected:'YOUR $5,000 BONUS IS LOSING VALUE',
    assetIdx:-1, assetChange:0,
    instruments:[
      {type:'hedge',name:'Lock in today\'s exchange rate',desc:'Fix the rate now with a forward contract â€” know exactly what you get.',cost:200,outcome:'Rate locked. When dollar falls further, you\'re fully protected.',outcomeDelta:+300,score:1},
      {type:'spec',name:'Wait â€” bet the dollar recovers',desc:'Hold your dollars and hope for a rebound before converting.',cost:0,outcome:'Dollar weakens further. You convert at a worse rate than today.',outcomeDelta:-250,score:5},
      {type:'neutral',name:'Convert half now, hold half',desc:'Split the risk â€” convert 50% today, leave the rest open.',cost:0,outcome:'Balanced outcome. You capture some protection, some upside.',outcomeDelta:+100,score:3},
      {type:'hedge',name:'Convert everything immediately',desc:'No FX risk â€” convert all dollars to euros at today\'s rate.',cost:0,outcome:'Clean exit. Dollar drops further â€” you avoided the extra loss.',outcomeDelta:+200,score:2},
    ]
  },
  {
    title:'MARKETS ARE FALLING',
    desc:'Bad news hits â€” stocks across your portfolio are dropping. Everyone is panicking. You have cash and need to decide what to do right now.',
    affected:'ALL YOUR ASSETS ARE DOWN TODAY',
    assetIdx:-1, assetChange:-0.05,
    instruments:[
      {type:'hedge',name:'Put a safety net on my portfolio',desc:'Pay a small amount to protect against further losses. Limits how much worse things can get.',cost:700,outcome:'Smart move â€” the market keeps falling but your safety net cushions the blow.',outcomeDelta:+600,score:1},
      {type:'spec',name:'Bet the market keeps falling',desc:'Open a trade that makes money if prices keep dropping. High risk, high reward.',cost:1000,outcome:'Markets find a floor and bounce back â€” your bet loses money.',outcomeDelta:-800,score:5},
      {type:'neutral',name:'Buy more assets at lower prices',desc:'Use your cash to buy while everything is cheap and wait for recovery.',cost:1500,outcome:'Markets recover over the next few days â€” your extra purchase gains in value.',outcomeDelta:+400,score:3},
      {type:'hedge',name:'Do nothing and wait it out',desc:'Stay calm. Keep everything as is. Market drops are usually temporary.',cost:0,outcome:'Markets partially recover. Staying patient avoided locking in losses.',outcomeDelta:+200,score:2},
    ]
  }
];

function initTrading(){
  cash=10000;
  assets=[
    {name:'TECH STOCK (SAP SE)',base:4500,current:4500,pnl:0},
    {name:'OIL ETF',base:3500,current:3500,pnl:0},
    {name:'EURO BONDS',base:4500,current:4500,pnl:0}
  ];
  eventIdx=0;tradeChoices=[];
  renderEventCounter();
  updatePortfolioUI();
  renderEvent();
}

function renderEventCounter(){
  document.getElementById('eventCounter').innerHTML=
    EVENTS.map((_,i)=>`<div class="ev-dot ${i<eventIdx?'done':i===eventIdx?'active':''}" id="evdot_${i}"></div>`).join('');
}

function updatePortfolioUI(){
  document.getElementById('cashDisplay').textContent='â‚¬'+cash.toLocaleString();
  const aList=document.getElementById('assetsList');
  aList.innerHTML=assets.map(a=>{
    const pnlPct=a.base?((a.current-a.base)/a.base*100).toFixed(1):0;
    const up=a.current>=a.base;
    return `<div class="asset-row">
      <div class="asset-name">${a.name}</div>
      <div class="asset-val">â‚¬${a.current.toLocaleString()}</div>
      <div class="asset-pnl ${up?'up':'dn'}">${up?'â–²':'â–¼'} ${Math.abs(pnlPct)}%</div>
    </div>`;
  }).join('');
  const total=cash+assets.reduce((s,a)=>s+a.current,0);
  const tv=document.getElementById('totalVal');
  tv.textContent='â‚¬'+total.toLocaleString();
  tv.className='pt-val '+(total>22500?'up':total<22500?'dn':'neutral');
}

function renderEvent(){
  setProgress(((10+eventIdx)/20)*100);
  document.getElementById('eventStep').textContent=`EVENT ${eventIdx+1} OF 5`;
  renderEventCounter();
  const ev=EVENTS[eventIdx];
  // Apply asset change immediately for visual effect
  if(ev.assetIdx>=0){
    assets[ev.assetIdx].current=Math.round(assets[ev.assetIdx].base*(1+ev.assetChange));
    assets[ev.assetIdx].pnl=assets[ev.assetIdx].current-assets[ev.assetIdx].base;
  } else if(ev.assetChange!==0){
    assets.forEach(a=>{a.current=Math.round(a.base*(1+ev.assetChange));a.pnl=a.current-a.base;});
  }
  updatePortfolioUI();

  document.getElementById('eventPanel').innerHTML=`
    <div class="event-card">
      <div class="event-top">
        <div class="breaking"><div class="breaking-dot"></div>BREAKING MARKET EVENT</div>
        <div class="event-title">${ev.title}</div>
        <div class="event-desc">${ev.desc}</div>
        <div class="affected-tag">âš  ${ev.affected}</div>
      </div>
      <div class="inst-grid" id="instGrid">
        ${ev.instruments.map((inst,i)=>`
          <div class="inst-card" id="ic_${i}" onclick="pickInstrument(${i})">
            <div class="inst-type ${inst.type}">${inst.type.toUpperCase()}</div>
            <div class="inst-name">${inst.name}</div>
            <div class="inst-desc">${inst.desc}</div>
            <div class="inst-cost">${inst.cost>0?'Cost: â‚¬'+inst.cost:'No cost'}</div>
          </div>`).join('')}
      </div>
    </div>`;
}

function pickInstrument(idx){
  const ev=EVENTS[eventIdx];
  const inst=ev.instruments[idx];
  if(cash<inst.cost){
    alert("Not enough cash for this option! Choose another.");
    return;
  }
  document.querySelectorAll('.inst-card').forEach((el,i)=>{
    el.classList.remove('sel-hedge','sel-spec','sel-neutral');
    el.classList.toggle('dimmed',i!==idx);
    el.style.pointerEvents='none';
  });
  document.getElementById(`ic_${idx}`).classList.add(`sel-${inst.type}`);
  // deduct cost
  cash=Math.max(0,cash-inst.cost);
  updatePortfolioUI();
  // store choice
  tradeChoices.push({type:inst.type,score:inst.score,event:ev.title});
  responses['Q'+(11+eventIdx)]=inst.type.charAt(0).toUpperCase()+inst.type.slice(1);
  // show outcome after delay
  setTimeout(()=>showOutcome(inst,ev),700);
}

function showOutcome(inst,ev){
  const pos=inst.outcomeDelta>=0;
  const neutral=inst.outcomeDelta===0;
  // apply outcome delta to portfolio
  cash=Math.round(cash+Math.max(0,inst.outcomeDelta));
  if(ev.assetIdx>=0){
    assets[ev.assetIdx].current=Math.max(0,assets[ev.assetIdx].current+Math.min(0,inst.outcomeDelta));
  }
  updatePortfolioUI();

  const overlay=document.getElementById('outcomeOverlay');
  overlay.innerHTML=`
    <div class="outcome-box">
      <div class="outcome-emoji">${neutral?'ğŸ¤':pos?'ğŸ“ˆ':'ğŸ“‰'}</div>
      <div class="outcome-title ${neutral?'neutral':pos?'good':'bad'}">${neutral?'STEADY HAND':pos?'GOOD CALL':'MARKET WINS'}</div>
      <div class="outcome-delta ${pos||neutral?'pos':'neg'}">${inst.outcomeDelta>=0?'+':''}â‚¬${Math.abs(inst.outcomeDelta).toLocaleString()} portfolio impact</div>
      <div class="outcome-desc">${inst.outcome}</div>
      <button class="btn" onclick="nextEvent()">${eventIdx<4?'NEXT EVENT â†’':'SEE RESULTS â†’'}</button>
    </div>`;
  overlay.classList.add('active');
}

function nextEvent(){
  document.getElementById('outcomeOverlay').classList.remove('active');
  eventIdx++;
  if(eventIdx<5){
    renderEvent();
  } else {
    // Update asset bases for final state
    enterSection('D');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION D â€” IMS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const imsStmts=[
  'I am highly motivated to actively participate in derivatives markets.',
  'I constantly look for new opportunities to trade derivatives instruments.',
  'My motivation to trade derivatives has increased over time.',
  'I am driven to continuously learn more about derivatives markets.',
  'I feel confident and motivated when making derivatives trading decisions.'
];

function renderIMS(idx){
  const qn=16+idx;
  setProgress(((15+idx)/20)*100);
  document.getElementById('secTag').textContent='SECTION D â€” INVESTOR MOTIVATION';
  document.getElementById('secTitle').textContent='YOUR MOTIVATION';
  document.getElementById('secStep').textContent=`Q${qn} of 20`;
  document.getElementById('nextBtn').style.display='none';
  const saved=responses['Q'+qn];
  document.getElementById('qArea').innerHTML=`
    <div class="lk-wrap">
      <div class="qlabel">QUESTION ${idx+1} OF 5 Â· RATE YOUR AGREEMENT</div>
      <div class="lk-stmt">${imsStmts[idx]}</div>
      <div class="lk-row">
        <div class="lk-end">Strongly<br>Disagree</div>
        <div class="lk-dots">
          ${[1,2,3,4,5].map(n=>`<div class="lk-dot ${saved===n?'sel':''}" id="ld_${n}" onclick="pickIMS(${n},'Q${qn}')">${n}</div>`).join('')}
        </div>
        <div class="lk-end r">Strongly<br>Agree</div>
      </div>
    </div>`;
  if(saved!==undefined) document.getElementById('nextBtn').style.display='inline-block';
}

function pickIMS(val,qid){
  document.querySelectorAll('.lk-dot').forEach(d=>d.classList.remove('sel'));
  document.getElementById(`ld_${val}`).classList.add('sel');
  responses[qid]=val;
  document.getElementById('nextBtn').style.display='inline-block';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FLOW CONTROL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startGame(){
  document.getElementById('intro').classList.remove('active');
  document.getElementById('game').classList.add('active');
  phase='A';qIdx=0;
  renderDemo(0);
}

function enterSection(s){
  phase=s;qIdx=0;
  if(s==='C'){
    document.getElementById('game').classList.remove('active');
    document.getElementById('tradingGame').classList.add('active');
    initTrading();
  } else {
    document.getElementById('tradingGame').classList.remove('active');
    document.getElementById('game').classList.add('active');
    if(s==='B') renderFL(0);
    else if(s==='D') renderIMS(0);
  }
}

function nextStep(){
  if(phase==='A'){
    qIdx++;
    if(qIdx<5) renderDemo(qIdx);
    else enterSection('B');
  } else if(phase==='B'){
    qIdx++;
    if(qIdx<5) renderFL(qIdx);
    else enterSection('C');
  } else if(phase==='D'){
    qIdx++;
    if(qIdx<5) renderIMS(qIdx);
    else submitData();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA SUBMISSION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function submitData(){
  document.getElementById('sendingOverlay').classList.add('on');
  const finalPortfolio = cash + assets.reduce((s,a)=>s+a.current,0);

  // Score map: each trade choice â†’ SM score + HED score for SPSS
  const scoreMap={
    'Speculative':{SM:5,HED:1},
    'Hedging':    {SM:1,HED:5},
    'Neutral':    {SM:3,HED:3},
    'Cautious':   {SM:2,HED:2}
  };
  const s11=scoreMap[responses.Q11]||{SM:'',HED:''};
  const s12=scoreMap[responses.Q12]||{SM:'',HED:''};
  const s13=scoreMap[responses.Q13]||{SM:'',HED:''};
  const s14=scoreMap[responses.Q14]||{SM:'',HED:''};
  const s15=scoreMap[responses.Q15]||{SM:'',HED:''};

  const payload={
    Timestamp: new Date().toISOString(),
    Q1_Gender: responses.Q1||'',
    Q2_Age: responses.Q2||'',
    Q3_Education: responses.Q3||'',
    Q4_Experience: responses.Q4||'',
    Q5_Instruments: Array.isArray(responses.Q5)?responses.Q5.join(';'):(responses.Q5||''),
    Q6_FL1: responses.Q6||'',
    Q7_FL2: responses.Q7||'',
    Q8_FL3: responses.Q8||'',
    Q9_FL4: responses.Q9||'',
    Q10_FL5: responses.Q10||'',
    Q11_Choice: responses.Q11||'', Q11_SM: s11.SM, Q11_HED: s11.HED,
    Q12_Choice: responses.Q12||'', Q12_SM: s12.SM, Q12_HED: s12.HED,
    Q13_Choice: responses.Q13||'', Q13_SM: s13.SM, Q13_HED: s13.HED,
    Q14_Choice: responses.Q14||'', Q14_SM: s14.SM, Q14_HED: s14.HED,
    Q15_Choice: responses.Q15||'', Q15_SM: s15.SM, Q15_HED: s15.HED,
    Q16_IMS1: responses.Q16||'',
    Q17_IMS2: responses.Q17||'',
    Q18_IMS3: responses.Q18||'',
    Q19_IMS4: responses.Q19||'',
    Q20_IMS5: responses.Q20||'',
    FinalPortfolioValue: finalPortfolio
  };

  console.log('=== RESEARCH DATA ==='); console.table(payload);

  if(SHEETS_URL && SHEETS_URL!=='https://script.google.com/macros/s/AKfycbyMi_DC4aQld8h-CO_WBQKB-9A1JSyXjIoEvWNBj3TBWwIKayHj0Qd4E5aYNd5WXCpzBQ/exec'){
    fetch(SHEETS_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)})
      .then(()=>showThankyou(finalPortfolio)).catch(()=>showThankyou(finalPortfolio));
  } else {
    setTimeout(()=>showThankyou(finalPortfolio),1400);
  }
}

function showThankyou(finalPort){
  document.getElementById('sendingOverlay').classList.remove('on');
  document.getElementById('game').classList.remove('active');
  document.getElementById('tradingGame').classList.remove('active');
  document.getElementById('thankyou').classList.add('active');
  setProgress(100);
  document.getElementById('tyFinalPort').textContent='â‚¬'+finalPort.toLocaleString();
  spawnConfetti();
}

// â”€â”€ CONFETTI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnConfetti(){
  const cols=['#00f5ff','#8b5cf6','#ff6b9d','#00e676','#ffb300'];
  const wrap=document.getElementById('confettiWrap');
  for(let i=0;i<90;i++){
    setTimeout(()=>{
      const p=document.createElement('div');
      p.className='cp';
      p.style.cssText=`left:${Math.random()*100}vw;background:${cols[i%cols.length]};animation-duration:${Math.random()*2+2}s;animation-delay:${Math.random()*1.5}s;width:${Math.random()*8+4}px;height:${Math.random()*8+4}px;`;
      wrap.appendChild(p);
      setTimeout(()=>p.remove(),4500);
    },i*25);
  }
}
</script>

<!--
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
GOOGLE SHEETS SETUP â€” READ THIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Create a new Google Sheet.
Add these exact headers in Row 1:
Timestamp | Q1_Gender | Q2_Age | Q3_Education | Q4_Experience | Q5_Instruments |
Q6_FL1 | Q7_FL2 | Q8_FL3 | Q9_FL4 | Q10_FL5 |
Q11_TechEvent | Q12_OilEvent | Q13_RateEvent | Q14_FXEvent | Q15_CrashEvent |
Q16_IMS1 | Q17_IMS2 | Q18_IMS3 | Q19_IMS4 | Q20_IMS5 | FinalPortfolioValue

STEP 2: Extensions â†’ Apps Script â†’ paste this:

function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  sheet.appendRow([
    data.Timestamp,
    data.Q1_Gender, data.Q2_Age, data.Q3_Education, data.Q4_Experience, data.Q5_Instruments,
    data.Q6_FL1, data.Q7_FL2, data.Q8_FL3, data.Q9_FL4, data.Q10_FL5,
    data.Q11_Choice, data.Q11_SM, data.Q11_HED,
    data.Q12_Choice, data.Q12_SM, data.Q12_HED,
    data.Q13_Choice, data.Q13_SM, data.Q13_HED,
    data.Q14_Choice, data.Q14_SM, data.Q14_HED,
    data.Q15_Choice, data.Q15_SM, data.Q15_HED,
    data.Q16_IMS1, data.Q17_IMS2, data.Q18_IMS3, data.Q19_IMS4, data.Q20_IMS5,
    data.FinalPortfolioValue
  ]);
  return ContentService.createTextOutput('OK');
}

STEP 3: Deploy â†’ New Deployment â†’ Web App
  - Execute as: Me
  - Who has access: Anyone
  Copy the Web App URL.

STEP 4: Replace 'https://script.google.com/macros/s/AKfycbyMi_DC4aQld8h-CO_WBQKB-9A1JSyXjIoEvWNBj3TBWwIKayHj0Qd4E5aYNd5WXCpzBQ/exec' in this file with that URL.

STEP 5: Export Google Sheet as CSV â†’ Import to SPSS.
  Columns Q6â€“Q10 = FL factor items (Likert 1â€“5)
  Columns Q11â€“Q15 = SM/HED items (Hedge/Spec/Neutral/Cautious)
  Columns Q16â€“Q20 = IMS factor items (Likert 1â€“5)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
</body>
</html>
